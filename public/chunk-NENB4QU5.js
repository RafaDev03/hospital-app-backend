import{a as R}from"./chunk-UW666MUF.js";import{a as O}from"./chunk-HZMAKCER.js";import{a as Y}from"./chunk-PDI3HUYS.js";import{a as N}from"./chunk-HKRDGOX6.js";import"./chunk-DKJA5FGH.js";import"./chunk-WGZ3CRYS.js";import{d as P,f as $,j,k as L,l as W,n as q}from"./chunk-ASKZ6QKQ.js";import{j as D}from"./chunk-4PVG4ZNA.js";import{D as U,Ja as g,La as y,Pa as f,Qa as T,Ra as V,Sa as k,Ta as t,U as w,Ua as n,Va as x,Y as m,Ya as C,Z as u,Za as _,_a as p,db as S,eb as r,fb as b,hb as M,ib as I,jb as F,kb as A,mb as B,ua as E,xa as c,ya as h}from"./chunk-OW2OVBTG.js";import{d as G}from"./chunk-5FZOKLP6.js";var v=G(Y());function H(o,l){o&1&&(t(0,"div",0)(1,"div",1)(2,"div",7)(3,"h4",8),r(4,"Cargando"),n(),x(5,"i",9),t(6,"p",10),r(7,"Por favor espere"),n()()()())}function J(o,l){o&1&&(t(0,"span",26),r(1,"Google"),n())}function K(o,l){o&1&&(t(0,"span",27),r(1,"Email"),n())}function Q(o,l){if(o&1){let s=C();t(0,"tr")(1,"th",17)(2,"img",18),_("click",function(){let a=m(s).$implicit,d=p(2);return u(d.openModal(a))}),n()(),t(3,"td"),r(4),n(),t(5,"td"),r(6),n(),t(7,"td")(8,"select",19),A("ngModelChange",function(i){let d=m(s).$implicit;return F(d.role,i)||(d.role=i),u(i)}),_("change",function(){let a=m(s).$implicit,d=p(2);return u(d.updateRole(a))}),t(9,"option",20),r(10,"Admin"),n(),t(11,"option",21),r(12,"User"),n()()(),t(13,"td"),g(14,J,2,0,"span",22)(15,K,2,0),n(),t(16,"td",23)(17,"a",24),_("click",function(){let a=m(s).$implicit,d=p(2);return u(d.deleteUser(a))}),x(18,"i",25),n()()()}if(o&2){let s=l.$implicit;c(2),y("src",s.getImageUrl,E),c(2),b(s.email),c(2),b(s.name),c(2),I("ngModel",s.role),c(6),f(14,s.google?14:15)}}function X(o,l){if(o&1){let s=C();t(0,"button",28),_("click",function(){m(s);let i=p(2);return u(i.cambiarPagina(-5))}),r(1," Anterior "),n(),r(2," \xA0 "),t(3,"button",28),_("click",function(){m(s);let i=p(2);return u(i.cambiarPagina(5))}),r(4," Seguiente "),n()}}function Z(o,l){if(o&1&&(t(0,"div",0)(1,"div",1),x(2,"div",2),t(3,"div",2)(4,"div",3)(5,"h5",11),r(6),n(),t(7,"div",12)(8,"table",13)(9,"thead")(10,"tr")(11,"th",14),r(12,"Imagen"),n(),t(13,"th",15),r(14,"Email"),n(),t(15,"th",15),r(16,"Name"),n(),t(17,"th",16),r(18,"Role"),n(),t(19,"th",14),r(20,"Auth"),n(),t(21,"th",14),r(22,"Actions"),n()()(),t(23,"tbody"),V(24,Q,19,5,"tr",null,T),n()()(),g(26,X,5,0),n()()()()),o&2){let s=p(),e=S(5);c(6),M("Users (",s.totalUsers,") - (",s.desde,")"),c(18),k(s.users),c(2),f(26,e.value.length===0?26:-1)}}var ce=(()=>{let l=class l{constructor(e,i,a){this.userService=e,this.searchService=i,this.modalService=a,this.totalUsers=0,this.users=[],this.usersTemp=[],this.desde=0,this.cargando=!0}ngOnDestroy(){this.imgSub?.unsubscribe()}ngOnInit(){this.findUsers(),this.imgSub=this.modalService.newImg.pipe(U(100)).subscribe(e=>this.findUsers())}cambiarPagina(e){this.desde+=e,this.desde<0?this.desde=0:this.desde>this.totalUsers&&(this.desde-=e),this.findUsers()}findUsers(){this.cargando=!0,this.userService.findUsers(this.desde).subscribe(e=>{this.totalUsers=e.count,this.users=e.users,this.usersTemp=e.users,this.cargando=!1})}deleteUser(e){if(e.id===this.userService.user?.id)return v.default.fire("Error","No puede borrarse a si mismo","error");v.default.fire({title:"Delete User?",text:`Are you sure to delete the user : ${e.name}`,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(i=>{i.isConfirmed&&this.userService.deleteUsers(e.id).subscribe(a=>{a.ok&&(v.default.fire({title:"Deleted!",text:a.msg,icon:"success"}),this.findUsers())})})}updateUser(e){}search(e){if(e.length===0)return this.users=this.usersTemp;this.searchService.search("users",e).subscribe(i=>{this.users=i,console.log(i)})}updateRole(e){this.userService.saveUser(e).subscribe(i=>{console.log(i)})}openModal(e){this.modalService.openModal("users",e)}};l.\u0275fac=function(i){return new(i||l)(h(N),h(O),h(R))},l.\u0275cmp=w({type:l,selectors:[["app-users"]],standalone:!0,features:[B],decls:8,vars:2,consts:[[1,"row","animated","fadeIn","fast"],[1,"col-12"],[1,"card"],[1,"card-body"],["type","text","placeholder","Buscar usuarios",1,"form-control",3,"keyup"],["txtSearch",""],["class","row animated fadeIn fast"],["role","alert",1,"alert","alert-info","text-center"],[1,"alert-heading"],[1,"fa","fa-spin","fa-refresh","fa-2x"],[1,"mb-0"],[1,"card-title"],[1,"table-responsive"],[1,"table","table-hover"],["scope","col",1,"w100"],["scope","col"],["scope","col",1,"w140"],["scope","row"],["alt","imagen",1,"avatar","cursor",3,"src","click"],[1,"form-select",3,"ngModel","ngModelChange","change"],["value","ADMIN_ROLE"],["value","USER_ROLE"],["class","badge bg-danger"],[1,"text-nowrap","text-center"],["data-toggle","tooltip","data-original-title","Delete",1,"cursor",3,"click"],[1,"fa","fa-close","text-danger"],[1,"badge","bg-danger"],[1,"badge","bg-info"],[1,"btn","btn-secondary",3,"click"]],template:function(i,a){if(i&1){let d=C();t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"input",4,5),_("keyup",function(){m(d);let z=S(5);return u(a.search(z.value))}),n()()()()(),g(6,H,8,0,"div",6)(7,Z,27,3,"div",6)}i&2&&(c(6),f(6,a.cargando?6:-1),c(),f(7,a.cargando?-1:7))},dependencies:[D,q,L,W,j,P,$]});let o=l;return o})();export{ce as UsersComponent};
